## NFSの設定

### マスタ

まず，NFS経由でスレーブへ公開するディレクトリを作成します．
ここでは，`/opt/nfs`を公開します．

```text
$ sudo mkdir /opt/nfs
$ sudo chown 777 /opt/nfs
```

次に，NFSサーバをインストールします．

```text
$ sudo apt install nfs-kernel-server
```

NFSサーバの設定ファイルを編集し，`/opt/nfs`を公開する設定を追加します．
`/etc/exports`をエディタで開き，下記の行をファイルの末尾に追加します．

```text
/opt/nfs        *.naist.jp(rw,sync,no_subtree_check)
```

NFSサーバに設定ファイルを再読み込みさせます．

```text
$ sudo systemctl reload nfs-server
```

以上で，マスタにおけるNFSの設定は完了です．
最後に，ファイルを正しく共有できているか確認するために，エディタで`/opt/nfs`
以下にテスト用のファイルを作成しておきましょう．中身は何でも構いません．

### ワーカ

NFSクライアントをインストールします．

```text
$ sudo apt install nfs-common
```

マウントポイントを作成します．

```text
$ sudo mkdir /opt/nfs
```

マスタのディレクトリをスレーブからアクセス可能にします．
`/etc/fstab`を編集し，下記の行をファイルの末尾に追加します．

```text
163.221.190.224:/opt/nfs        /opt/nfs        nfs     defaults        0       0
```

`/etc/fstab`の設定を反映させます．

``` text
$ sudo mount -a
```

以上で，スレーブにおけるNFSの設定は完了です．
マスタで`/opt/nfs`に作成したファイルの中身が見えるか確認しましょう．

> **豆知識**: NFSでは，ワーカの数が増えるとマスタの負荷が増大し，ファイルの
> 読み書きが遅くなってしまうという問題があります．そのため，
> 大規模なスパコンでは，負荷を複数のコンピュータに分散できる，
> **並列ファイルシステム**が使用されています．
